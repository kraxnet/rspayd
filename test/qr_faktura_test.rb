require 'test_helper'

class QrFakturaTest < MiniTest::Test
  def test_example_1
    invoice = Rspayd::QrFaktura.new(
      id: '012150672',
      dd: 20151201,
      tp: 0,
      am: 495.00,
      vs: '012150672',
      vii: 'CZ60194383',
      ini: 60194383,
      vir: 'CZ12345678',
      duzp: 20151201,
      dt: 20151217,
      tb0: 409.09,
      t0: 85.91,
      cc: 'CZK',
      acc: 'CZ3103000000270016060243'
    )
    assert_equal 'SID*1.0*ID:012150672*DD:20151201*TP:0*AM:495.00*VS:012150672*VII:CZ60194383*INI:60194383*VIR:CZ12345678*DUZP:20151201*DT:20151217*TB0:409.09*T0:85.91*CC:CZK*ACC:CZ3103000000270016060243*', invoice.to_qr_invoice
    # assert_equal 'SPD*1.0*CC:CZK*ACC:CZ3103000000270016060243*AM:495.00*X-VS:012150672*X-INV:SID%2A1.0%2AID:012150672%2ADD:20151201%2ATP:0%2AVII:CZ60194383%2AINI:60194383%2AVIR:CZ12345678%2ADUZP:20151201%2ADT:20151217%2ATB0:409.09%2AT0:85.91*', invoice.to_qr_payment
    assert_equal 'SPD*1.0*AM:495.00*X-VS:012150672*DT:20151217*CC:CZK*ACC:CZ3103000000270016060243*X-INV:SID%2A1.0%2AID:012150672%2ADD:20151201%2ATP:0%2AVII:CZ60194383%2AINI:60194383%2AVIR:CZ12345678%2ADUZP:20151201%2ADT:20151217%2ATB0:409.09%2AT0:85.91*', invoice.to_qr_payment
  end

  def test_example_2
    invoice = Rspayd::QrFaktura.new(
      ID: 2001401154,
      DD: 20140404,
      TP: 9, #!!!
      AM: 61189.00,
      MSG: 'Dodávka vybavení interiéru hotelu Kamzík',
      VS: 3310001054,
      VII: 'CZ25568736',
      VIR: 'CZ25568736',
      INI: 25568736,
      INR: 25568736,
      DUZP: 20140404,
      DT: 20140412,
      TB0: 26492.70,
      T0: 5563.47,
      TB1: 25333.10,
      T1: 3799.97,
      NTB: -0.24,
      CC: 'CZK',
      TD: 0, #!!!
      SA: 0, #!!!
      ACC: 'CZ9701000000007098760287+KOMBCZPP',
      'X-SW'.to_sym => 'MoneyS5-1.7.1'
    )
    assert_equal 'SID*1.0*ID:2001401154*DD:20140404*TP:9*AM:61189.00*MSG:Dodávka vybavení interiéru hotelu Kamzík*VS:3310001054*VII:CZ25568736*INI:25568736*INR:25568736*VIR:CZ25568736*DUZP:20140404*DT:20140412*TB0:26492.70*T0:5563.47*TB1:25333.10*T1:3799.97*NTB:-0.24*CC:CZK*TD:0*SA:0*ACC:CZ9701000000007098760287+KOMBCZPP*X-SW:MoneyS5-1.7.1*', invoice.to_qr_invoice
    assert_equal 'SPD*1.0*AM:61189.00*X-VS:3310001054*DT:20140412*CC:CZK*ACC:CZ9701000000007098760287+KOMBCZPP*X-INV:SID%2A1.0%2AID:2001401154%2AMSG:Dodávka vybavení interiéru hotelu Kamzík%2ADD:20140404%2ATP:9%2AVII:CZ25568736%2AINI:25568736%2AINR:25568736%2AVIR:CZ25568736%2ADUZP:20140404%2ADT:20140412%2ATB0:26492.70%2AT0:5563.47%2ATB1:25333.10%2AT1:3799.97%2ANTB:-0.24%2ATD:0%2ASA:0%2AX-SW:MoneyS5-1.7.1*', invoice.to_qr_payment
  end
end
